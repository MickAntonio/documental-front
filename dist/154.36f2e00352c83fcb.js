"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[154],{5154:(ft,z,r)=>{r.r(z),r.d(z,{DocumentosPorClassificarModule:()=>v});var w=r(9299),te=r(1206),oe=r(7957),E=r(4859),ie=r(6709),U=r(3238),p=r(9602),G=r(4850),h=r(9549),y=r(7392),J=r(284),ne=r(9506),N=r(8255),V=r(3162),se=r(1948),O=r(4385),S=r(3267),ae=r(266),re=r(79),ce=r(4466),k=r(8739),B=r(3745),F=r(6308),j=r(7775),D=r(5412),T=r(7084),Z=r(3231),le=r(3848),$=r(455),me=r(8046),de=r(6562),ue=r(3817),K=r(2570),pe=r(7579),q=r(2722),ge=r(6451),he=r(3900),c=r(4006),fe=r(8288),f=r(529),L=r(9969),e=r(4650),_e=r(7751),xe=r(7490),H=r(5861),ve=r(3106),De=r(6189),Te=r(6652),Ze=r(5979),W=r(9424),X=r(4693),Ce=r(7756),d=r(6895),ee=r(811),Ie=r(8361);const be=["registoTipoSelector"];function Ae(s,o){if(1&s&&(e.TgZ(0,"mat-option",60),e._uU(1),e.qZA()),2&s){const t=o.$implicit;e.s9C("value",t.id),e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nome," ")}}function Re(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.username," ")}}function we(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Ne(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.nome," ")}}function Se(s,o){if(1&s&&(e.TgZ(0,"mat-option",60)(1,"div",61),e.YNc(2,Re,2,1,"span",62),e.YNc(3,we,2,1,"span",62),e.YNc(4,Ne,2,1,"span",62),e.qZA()()),2&s){const t=o.$implicit,i=e.oxw();e.Q6J("value",t.id),e.xp6(1),e.Q6J("ngSwitch",i.selectRemetente),e.xp6(1),e.Q6J("ngSwitchCase",1),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",3)}}function Fe(s,o){1&s&&e.GkF(0)}function Ee(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.username," ")}}function Ue(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ye(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.nome," ")}}function Je(s,o){if(1&s&&(e.TgZ(0,"mat-option",60)(1,"div",61),e.YNc(2,Ee,2,1,"span",62),e.YNc(3,Ue,2,1,"span",62),e.YNc(4,ye,2,1,"span",62),e.qZA()()),2&s){const t=o.$implicit,i=e.oxw(2);e.Q6J("value",t.id),e.xp6(1),e.Q6J("ngSwitch",i.selectDestinatario),e.xp6(1),e.Q6J("ngSwitchCase",1),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",3)}}function Oe(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"mat-select",63),e.NdJ("selectionChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.changeSelectDestinatario(n))}),e.TgZ(1,"mat-option")(2,"ngx-mat-select-search",64),e.NdJ("input",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.filterDestinatarios(n))}),e._UZ(3,"mat-icon",16),e.TgZ(4,"span",17),e._uU(5,"Op\xe7\xe3o n\xe3o encontrada2"),e.qZA()()(),e.YNc(6,Je,5,5,"mat-option",18),e.qZA()}if(2&s){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.searchDestinatarios)}}function ke(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.username," ")}}function qe(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Le(s,o){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.nome," ")}}function Qe(s,o){if(1&s&&(e.TgZ(0,"mat-option",60)(1,"div",61),e.YNc(2,ke,2,1,"span",62),e.YNc(3,qe,2,1,"span",62),e.YNc(4,Le,2,1,"span",62),e.qZA()()),2&s){const t=o.$implicit,i=e.oxw(2);e.Q6J("value",t.id),e.xp6(1),e.Q6J("ngSwitch",i.selectDestinatario),e.xp6(1),e.Q6J("ngSwitchCase",1),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",3)}}function Pe(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"mat-select",65),e.NdJ("selectionChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.changeSelectDestinatario(n))}),e.TgZ(1,"mat-option")(2,"ngx-mat-select-search",64),e.NdJ("input",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.filterDestinatarios(n))}),e._UZ(3,"mat-icon",16),e.TgZ(4,"span",17),e._uU(5,"Op\xe7\xe3o n\xe3o encontrada3"),e.qZA()()(),e.YNc(6,Qe,5,5,"mat-option",18),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("compareWith",t.compareFunctionObject),e.xp6(6),e.Q6J("ngForOf",t.searchDestinatarios)}}function Ye(s,o){if(1&s&&(e.TgZ(0,"mat-option",60),e._uU(1),e.qZA()),2&s){const t=o.$implicit;e.s9C("value",t.template.id),e.Q6J("value",t.template.id),e.xp6(1),e.hij(" ",t.template.nome," ")}}function Me(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"mat-form-field",13)(1,"mat-label"),e._uU(2,"Modelo de Documento"),e.qZA(),e.TgZ(3,"mat-select",66)(4,"mat-option")(5,"ngx-mat-select-search",15),e.NdJ("input",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.filterTipoDocumentosTemplates(n))}),e._UZ(6,"mat-icon",16),e.TgZ(7,"span",17),e._uU(8,"Op\xe7\xe3o n\xe3o encontrada"),e.qZA()()(),e.YNc(9,Ye,2,3,"mat-option",18),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(9),e.Q6J("ngForOf",t.searchTipoDocumentosTemplates)}}function ze(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"div",67)(1,"mat-accordion")(2,"mat-expansion-panel")(3,"mat-expansion-panel-header")(4,"mat-panel-title")(5,"span",68),e._uU(6," Campos do Tipo de Documento "),e.qZA()()(),e.TgZ(7,"entrada-dynamic-form",69),e.NdJ("form",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.getDynamicFormData(n))}),e.qZA()()()()}if(2&s){const t=e.oxw();e.xp6(7),e.Q6J("options",t.dynamicForm)}}const _=function(s){return{"text-primary":s}},Ge=function(s){return{"mt-10 ml-5":s}};class C{constructor(o,t,i,n,a,l,u,A,R,M){this._changeDetectorRef=o,this.dialog=t,this._route=i,this._formBuilder=n,this._tipoDocumentoService=a,this._estadoService=l,this._entidadeService=u,this._drawerService=A,this._userService=R,this._keycloakService=M,this.formulario=new e.vpe,this.alertMessage=new e.vpe,this.selectDestinatario=1,this.selectRemetente=1,this.alert={type:"success",message:""},this.anexos=new Array,this.anexosScanner=new Array,this.fileRequired=!1,this.registoTipo=this._route.snapshot.data.tipo,this.maxDate=new Date,"ENTRADA"==this.registoTipo?(this.fileRequired=!0,this.formTitulo="Nova Entrada"):"SAIDA"==this.registoTipo?this.formTitulo="Nova Sa\xedda":"INTERNO"==this.registoTipo&&(this.formTitulo="Documento Interno")}ngOnInit(){this.getEntidades(),this.getTipos(),this.getUser(),this.getUsers(),this.getGroups(),this.setupForm(),this.anexosInputSet(),this._changeDetectorRef.markForCheck()}anexosInputSet(){null!=this.anexosInputScanner&&(this.anexosInputScanner.forEach((o,t)=>{this.anexosNamesScanner=0==t?o.nome:this.anexosNamesScanner+", "+o.nome,this.anexosScanner.push(o.id)}),this.entradaForm.patchValue({anexosScanner:this.anexosScanner}))}ngAfterViewInit(){null==this.registoTipo&&(this.registoTipo=this.registoTipoSelector.value)}onToggleGroupChange(o){this.entradaForm.controls.registoTipo.setValue(o.value),this.registoTipo=o.value,this._changeDetectorRef.markForCheck()}setupForm(){if(this.entradaForm=this._formBuilder.group({id:new c.NI(this.registoDetail?.id),tipoId:new c.NI(this.registoDetail?.tipoId,[c.kI.required]),assunto:new c.NI(this.registoDetail?.assunto,[c.kI.required]),anexos:new c.NI(""),anexosScanner:new c.NI(""),data:new c.NI(this.registoDetail?.data),remetente:new c.NI("",[c.kI.required]),destinatario:new c.NI(""),confidencial:new c.NI(this.registoDetail?.confidencial),criadoPor:new c.NI(this.user?.username),username:new c.NI(this.user?.username),userId:new c.NI(this.user?.id),estado:new c.NI(this.registoDetail?.estado?.nome),registoTipo:new c.NI(this.registoTipo),valorAtributoDinamicos:new c.NI(null),registoRemetente:new c.NI([]),registoDestinatario:new c.NI([]),fileBase64:new c.NI(""),templateId:new c.NI("")}),this.setRemitenteUser(),"UTILIZADOR"==this.registoDetail?.registo_remetente?.tipo?(this.selectRemetente=1,this.changeRemetente(this.selectRemetente),this.entradaForm.patchValue({remetente:this.registoDetail?.registo_remetente?.utilizadorId}),this.entradaForm.patchValue({registoRemetente:{tipo:"UTILIZADOR",utilizadorId:this.registoDetail?.registo_remetente?.utilizadorId}})):"GRUPO"==this.registoDetail?.registo_remetente?.tipo?(this.selectRemetente=2,this.changeRemetente(this.selectRemetente),this.entradaForm.patchValue({remetente:this.registoDetail?.registo_remetente?.grupoId}),this.entradaForm.patchValue({registoRemetente:{tipo:"GRUPO",grupoId:this.registoDetail?.registo_remetente?.grupoId}})):"ENTIDADE"==this.registoDetail?.registo_remetente?.tipo&&(this.selectRemetente=3,this.changeRemetente(this.selectRemetente),this.entradaForm.patchValue({remetente:this.registoDetail?.registo_remetente?.entidadeId}),this.entradaForm.patchValue({registoRemetente:{tipo:"ENTIDADE",entidadeId:this.registoDetail?.registo_remetente?.entidadeId}})),this.registoDetail?.id>0&&(this.fileRequired=!1,this.setDestinatariosSelect(this.registoDetail?.registo_destinatario),this.registoDetail.tipo.atributosDinamico)){let o=this.tipoDocumentos.find(t=>t.id==this.registoDetail.tipo.id);this.dynamicForm=o?.atributos_dinamicos,this.showStributosDinamicos=!0}this.anexosNames="",this.anexosNamesScanner=""}ngOnDestroy(){this._drawerService.close()}setDestinatariosSelect(o){var t=[];o.forEach(i=>{let n={};"UTILIZADOR"==i.tipo?(n={id:i.utilizadorId,tipo:"UTILIZADOR",utilizadorId:i.utilizadorId,grupoId:null,entidadeId:null},this.selectDestinatario=1):"GRUPO"==i.tipo?(n={id:i.grupoId,tipo:"GRUPO",utilizadorId:null,grupoId:i.grupoId,entidadeId:null},this.selectDestinatario=2):"ENTIDADE"==i.tipo&&(n={id:i.entidadeId,tipo:"ENTIDADE",utilizadorId:null,entidadeId:i.entidadeId},this.selectDestinatario=3),t.push(n)}),this.entradaForm.patchValue({registoDestinatario:t}),this.changeDestinatario(this.selectDestinatario),this.entradaForm.patchValue({destinatario:t})}compareFunctionObject(o,t){return o==t?.id}trackByFn(o,t){return t.id||o}changeDestinatario(o){switch(this.selectDestinatario=o,o){case 1:this.searchDestinatarios=this.users;break;case 2:this.searchDestinatarios=this.groups;break;case 3:this.searchDestinatarios=this.entidades}let t=[];t=this.entradaForm.get("registoDestinatario").value,t.map(i=>{let n={};if("UTILIZADOR"==i.tipo){switch(n=this.users.find(a=>a.id==i.utilizadorId),n.tipo="UTILIZADOR",o){case 1:n.username=n.username;break;case 2:n.name=n.username;break;case 3:n.nome=n.username}this.searchDestinatarios.unshift(n)}else if("GRUPO"==i.tipo){switch(n=this.groups.find(a=>a.id==i.grupoId),n.tipo="GRUPO",o){case 1:n.username=n.name;break;case 2:n.name=n.name;break;case 3:n.nome=n.name}this.searchDestinatarios.unshift(n)}else if("ENTIDADE"==i.tipo){switch(n=this.entidades.find(a=>a.id==i.entidadeId),n.tipo="ENTIDADE",o){case 1:n.username=n.nome;break;case 2:n.name=n.nome;break;case 3:n.nome=n.nome}this.searchDestinatarios.unshift(n)}}),this.searchDestinatarios=this.searchDestinatarios?.filter((i,n,a)=>n===a.findIndex(l=>l.id===i.id))}changeRemetente(o){switch(this.selectRemetente=o,o){case 1:this.searchRemetentes=this.users.filter((t,i,n)=>(null==t.tipo||"UTILIZADOR"==t.tipo)&&i===n.findIndex(a=>a.id===t.id));break;case 2:this.searchRemetentes=this.groups.filter((t,i,n)=>(null==t.tipo||"GRUPO"==t.tipo)&&i===n.findIndex(a=>a.id===t.id));break;case 3:this.searchRemetentes=this.entidades.filter((t,i,n)=>(null==t.tipo||"ENTIDADE"==t.tipo)&&i===n.findIndex(a=>a.id===t.id))}}filterTipo(o){let t=this.tipoDocumentos.find(i=>i.id==o);t.atributosDinamico?(this.dynamicForm=t?.atributos_dinamicos,this.showStributosDinamicos=!0):this.showStributosDinamicos=!1,this.tipoDocumentosTemplates=t.tipo_templates,this.searchTipoDocumentosTemplates=t.tipo_templates}filterTipoTemplate(o){this.tipoDocumentosTemplates.find(i=>i.id==o)}sendForm(){this.formulario.emit(this.entradaForm),null==this.registoDetail?.id&&this.setupForm()}getDynamicFormData(o){this.entradaForm.patchValue({valorAtributoDinamicos:o.value})}getTipos(){this._tipoDocumentoService.tipoDocumentos$.subscribe(o=>{this.tipoDocumentos=o,this.searchTipoDocumentos=this.tipoDocumentos})}getEntidades(){this._entidadeService.entidades$.subscribe(o=>{this.entidades=o})}getUsers(){this._userService.users$.subscribe(o=>{this.users=o,this.searchRemetentes=o,this.searchDestinatarios=o})}getGroups(){this._userService.groups$.subscribe(o=>{this.groups=o})}getUser(){var o=this;return(0,H.Z)(function*(){o.user=yield o._keycloakService.loadUserProfile(),o.entradaForm.patchValue({criadoPor:o.user?.username,username:o.user?.username,userId:o.user?.id})})()}setRemitenteUser(){var o=this;return(0,H.Z)(function*(){o.user=yield o._keycloakService.loadUserProfile(),o.selectRemetente=1,o.entradaForm.patchValue({remetente:o.user?.id}),o.entradaForm.patchValue({registoRemetente:{tipo:"UTILIZADOR",utilizadorId:o.user?.id}}),o.changeRemetente(o.selectRemetente)})()}filterTipoDocumentos(o){this.searchTipoDocumentos=this.tipoDocumentos.filter(t=>t.nome.includes(o.target.value))}filterTipoDocumentosTemplates(o){this.searchTipoDocumentosTemplates=this.tipoDocumentosTemplates.filter(t=>t.nome.includes(o.target.value))}filterRemetentes(o){switch(this.selectRemetente){case 1:this.searchRemetentes=this.users.filter(t=>t.username.includes(o.target.value));break;case 2:this.searchRemetentes=this.groups.filter(t=>t.name.includes(o.target.value));break;case 3:this.searchRemetentes=this.entidades.filter(t=>t.nome.includes(o.target.value))}}filterDestinatarios(o){switch(this.selectRemetente){case 1:this.searchDestinatarios=this.users.filter(t=>t.username.includes(o.target.value));break;case 2:this.searchDestinatarios=this.groups.filter(t=>t.name.includes(o.target.value));break;case 3:this.searchDestinatarios=this.entidades.filter(t=>t.nome.includes(o.target.value))}}changeSelectRemetente(o){let t={};switch(this.selectRemetente){case 1:t={tipo:"UTILIZADOR",utilizadorId:o.value};break;case 2:t={tipo:"GRUPO",grupoId:o.value};break;case 3:t={tipo:"ENTIDADE",entidadeId:o.value}}this.entradaForm.patchValue({registoRemetente:t})}changeSelectDestinatario(o){let t={},i=o?.value?.pop();switch(o?.value?.push(i),this.selectDestinatario){case 1:t={tipo:"UTILIZADOR",utilizadorId:i};break;case 2:t={tipo:"GRUPO",grupoId:i};break;case 3:t={tipo:"ENTIDADE",entidadeId:i}}let n=[],a=[];a=this.entradaForm.get("registoDestinatario").value,n=this.entradaForm.get("destinatario").value,n?.length>a?.length?(a.push(t),this.entradaForm.patchValue({registoDestinatario:a})):n?.length<a?.length&&(a.pop(),this.entradaForm.patchValue({registoDestinatario:a}))}triggerSelectFile(o){document.querySelector('ngx-mat-file-input[formcontrolname="fileBase64"] input[type="file"]').click()}handleFileSelect(o){const t=this.entradaForm.get("fileBase64").value;this.anexos=new Array,t.forEach((i,n)=>{if(i){const a=new FileReader;a.readAsDataURL(i),a.onload=()=>{const l=a.result,u=i.name,A=i.size,R=u.split(".").pop();this.anexos.push({file:l,name:u.substring(0,i.name.lastIndexOf(".")),size:A,extension:"."+R})},this.anexosNames=0==n?i.name:this.anexosNames+", "+i.name}}),console.log("anexosNames"),console.log(this.anexosNames),this.entradaForm.patchValue({anexos:this.anexos})}scannerOpenDialog(){this.dialog.open(ve.i).updateSize("800px","500px").afterClosed().subscribe(t=>{null!=t&&(t.documentos.forEach((i,n)=>{this.anexosNamesScanner=0==n?i.nome:this.anexosNamesScanner+", "+i.nome,this.anexosScanner.push(i.id)}),console.log("anexosNames"),console.log(this.anexosScanner),this.entradaForm.patchValue({anexosScanner:this.anexosScanner}),this._changeDetectorRef.markForCheck())})}}C.\u0275fac=function(o){return new(o||C)(e.Y36(e.sBO),e.Y36(D.uw),e.Y36(w.gz),e.Y36(c.QS),e.Y36(De.D),e.Y36(Te.Y),e.Y36(Ze.b),e.Y36(W.z),e.Y36(X.f),e.Y36(Ce.MZ))},C.\u0275cmp=e.Xpm({type:C,selectors:[["entrada-registo-form"]],viewQuery:function(o,t){if(1&o&&e.Gf(be,5),2&o){let i;e.iGM(i=e.CRH())&&(t.registoTipoSelector=i.first)}},inputs:{registoDetail:"registoDetail",anexosInputScanner:"anexosInputScanner"},outputs:{formulario:"formulario",alertMessage:"alertMessage"},decls:122,vars:44,consts:[[1,"flex","flex-auto","overflow-scroll","bg-white"],[1,"flex","flex-col","flex-auto","p-4",3,"formGroup"],[1,"flex","justify-center"],[1,"ml-2","mb-4","uppercase"],[1,"mb-3"],[1,"flex","justify-center","mb-4"],["value","ENTRADA",2,"border-radius","0px",3,"change"],["registoTipoSelector","matButtonToggleGroup"],["value","INTERNO",2,"border-radius","2px"],["value","ENTRADA",2,"border-radius","2px"],["value","SAIDA",2,"border-radius","2px"],[1,"mt-3","mb-4"],[1,"flex","gap-2"],[1,"flex-auto"],["formControlName","tipoId","required","",3,"selectionChange"],["placeholderLabel","Pesquisar a tipo de documento..",3,"input"],["svgIcon","heroicons_outline:x"],["ngxMatSelectNoEntriesFound",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","maxlength","250","formControlName","assunto",3,"placeholder"],[1,"w-[50%]"],[1,"flex","flex-auto","flex-col"],[1,"text-lg","mb-2"],[2,"color","red"],[1,"flex","w-full","mb-1"],["disabled","","type","button",1,"py-3","px-2","w-[100%]","flex","justify-between",2,"border-radius","4px!important","background-color","#f1f0f0","margin-top","-7px",3,"matMenuTriggerFor"],[1,"flex","justify-between"],[1,"mt-1"],[1,"scale-[.75]",3,"svgIcon"],["moreMenu","matMenu"],[1,"flex-auto","w-[25%]",2,"display","none"],["hidden","","formControlName","fileBase64","placeholder","Importar no PC","multiple","","accept","*",1,"file-size",3,"color","required","change"],["arquivo",""],["mat-menu-item","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","items-start","justify-center"],[1,"text-lg"],[1,"text-sm"],[1,"flex","flex-auto","w-[50%]"],["matInput","","formControlName","data","placeholder","Data",3,"matDatepicker","max"],["matSuffix","",3,"for"],["picker",""],[1,"flex","gap-3"],[1,"flex","w-full","justify-between","mb-1"],[1,"w-[34%]","border","cursor-pointer","dest-first",3,"ngClass","click"],[1,"w-[33%]","border","cursor-pointer",3,"ngClass","click"],[1,"w-[33%]","border","cursor-pointer","dest-last",3,"ngClass","click"],["required","","formControlName","remetente",3,"selectionChange"],["placeholderLabel","Pesquisar remetente...",3,"input"],[4,"ngIf","ngIfThen","ngIfElse"],["newDestinatarios",""],["updateDestinatarios",""],[1,"flex"],["class","flex-auto",4,"ngIf"],[1,"flex-auto",3,"ngClass"],["color","warn","formControlName","confidencial"],["class","mt-8",4,"ngIf"],[1,"flex","justify-end","mt-10"],["mat-flat-button","","type","button",1,"px-8",3,"color","disabled","click"],[1,"ml-2","mr-1"],[3,"value"],[3,"ngSwitch"],[4,"ngSwitchCase"],["multiple","","formControlName","destinatario",3,"selectionChange"],["placeholderLabel","Pesquisar destinat\xe1rio...",3,"input"],["multiple","","formControlName","destinatario",3,"compareWith","selectionChange"],["formControlName","templateId"],[1,"mt-8"],[1,"text-2xl"],[3,"options","form"]],template:function(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"span",3),e._uU(4,"Formul\xe1rio para classificar novos documentos"),e.qZA()(),e.TgZ(5,"div"),e._UZ(6,"mat-divider",4),e.TgZ(7,"div",5)(8,"mat-button-toggle-group",6,7),e.NdJ("change",function(a){return t.onToggleGroupChange(a)}),e.TgZ(10,"mat-button-toggle",8),e._uU(11,"INTERNO"),e.qZA(),e.TgZ(12,"mat-button-toggle",9),e._uU(13,"ENTRADA"),e.qZA(),e.TgZ(14,"mat-button-toggle",10),e._uU(15,"SA\xcdDA"),e.qZA()()(),e._UZ(16,"mat-divider",11),e.TgZ(17,"div",12)(18,"mat-form-field",13)(19,"mat-label"),e._uU(20,"Tipo de Documento"),e.qZA(),e.TgZ(21,"mat-select",14),e.NdJ("selectionChange",function(a){return t.filterTipo(a.value)}),e.TgZ(22,"mat-option")(23,"ngx-mat-select-search",15),e.NdJ("input",function(a){return t.filterTipoDocumentos(a)}),e._UZ(24,"mat-icon",16),e.TgZ(25,"span",17),e._uU(26,"Op\xe7\xe3o n\xe3o encontrada"),e.qZA()()(),e.YNc(27,Ae,2,3,"mat-option",18),e.qZA()(),e.TgZ(28,"mat-form-field",13)(29,"mat-label"),e._uU(30,"Assunto"),e.qZA(),e._UZ(31,"input",19),e.qZA()(),e._UZ(32,"div",12),e.TgZ(33,"div",12)(34,"div",20)(35,"div",21)(36,"span",22),e._uU(37,"Ficheiros "),e.TgZ(38,"span",23),e._uU(39,"*"),e.qZA()(),e.TgZ(40,"div",24)(41,"button",25)(42,"div",26)(43,"mat-icon"),e._uU(44,"attach_file"),e.qZA(),e.TgZ(45,"span",27),e._uU(46),e.qZA()(),e._UZ(47,"mat-icon",28),e.qZA(),e.TgZ(48,"mat-menu",null,29)(50,"mat-form-field",30)(51,"mat-label"),e._uU(52,"Ficheiro(s)"),e.qZA(),e.TgZ(53,"ngx-mat-file-input",31,32),e.NdJ("change",function(a){return t.handleFileSelect(a)}),e.qZA()(),e.TgZ(55,"button",33),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(54);return e.KtG(t.triggerSelectFile(a))}),e._UZ(56,"mat-icon",34),e.TgZ(57,"div",35)(58,"span",36),e._uU(59,"Importar"),e.qZA(),e.TgZ(60,"span",37),e._uU(61,"ficheiros no computador"),e.qZA()()(),e.TgZ(62,"button",33),e.NdJ("click",function(){return t.scannerOpenDialog()}),e._UZ(63,"mat-icon",34),e.TgZ(64,"div",35)(65,"span",36),e._uU(66,"Scanner"),e.qZA(),e.TgZ(67,"span",37),e._uU(68,"ficheiros no scanner"),e.qZA()()()()()()(),e.TgZ(69,"mat-form-field",38)(70,"mat-label"),e._uU(71,"Data"),e.qZA(),e._UZ(72,"input",39)(73,"mat-datepicker-toggle",40)(74,"mat-datepicker",null,41),e.qZA()(),e.TgZ(76,"div",42)(77,"div",21)(78,"span",22),e._uU(79,"Remetente"),e.qZA(),e.TgZ(80,"div",43)(81,"a",44),e.NdJ("click",function(){return t.changeRemetente(1)}),e._uU(82,"Utilizadores"),e.qZA(),e.TgZ(83,"a",45),e.NdJ("click",function(){return t.changeRemetente(2)}),e._uU(84,"Grupos"),e.qZA(),e.TgZ(85,"a",46),e.NdJ("click",function(){return t.changeRemetente(3)}),e._uU(86,"Entidades"),e.qZA()(),e.TgZ(87,"mat-form-field",13)(88,"mat-select",47),e.NdJ("selectionChange",function(a){return t.changeSelectRemetente(a)}),e.TgZ(89,"mat-option")(90,"ngx-mat-select-search",48),e.NdJ("input",function(a){return t.filterRemetentes(a)}),e._UZ(91,"mat-icon",16),e.TgZ(92,"span",17),e._uU(93,"Op\xe7\xe3o n\xe3o encontrada"),e.qZA()()(),e.YNc(94,Se,5,5,"mat-option",18),e.qZA()()(),e.TgZ(95,"div",21)(96,"span",22),e._uU(97,"Destinat\xe1rio"),e.qZA(),e.TgZ(98,"div",43)(99,"a",44),e.NdJ("click",function(){return t.changeDestinatario(1)}),e._uU(100,"Utilizadores"),e.qZA(),e.TgZ(101,"a",45),e.NdJ("click",function(){return t.changeDestinatario(2)}),e._uU(102,"Grupos"),e.qZA(),e.TgZ(103,"a",46),e.NdJ("click",function(){return t.changeDestinatario(3)}),e._uU(104,"Entidades"),e.qZA()(),e.TgZ(105,"mat-form-field",13),e.YNc(106,Fe,1,0,"ng-container",49),e.YNc(107,Oe,7,1,"ng-template",null,50,e.W1O),e.YNc(109,Pe,7,2,"ng-template",null,51,e.W1O),e.qZA()()(),e.TgZ(111,"div",52),e.YNc(112,Me,10,1,"mat-form-field",53),e.TgZ(113,"div",54)(114,"mat-slide-toggle",55),e._uU(115,"Confidencial"),e.qZA()()()(),e.YNc(116,ze,8,1,"div",56),e.TgZ(117,"div",57)(118,"button",58),e.NdJ("click",function(){return t.sendForm()}),e._UZ(119,"mat-icon",34),e.TgZ(120,"span",59),e._uU(121,"Salvar Entrada"),e.qZA()()()()()}if(2&o){const i=e.MAs(49),n=e.MAs(75),a=e.MAs(108),l=e.MAs(110);e.xp6(1),e.Q6J("formGroup",t.entradaForm),e.xp6(26),e.Q6J("ngForOf",t.searchTipoDocumentos),e.xp6(4),e.Q6J("placeholder","Informe o assunto"),e.xp6(10),e.Q6J("matMenuTriggerFor",i),e.xp6(5),e.AsE("",t.anexosNames," ",t.anexosNamesScanner,""),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:chevron-down"),e.xp6(6),e.Q6J("color","accent")("required",t.fileRequired),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:desktop-computer"),e.xp6(7),e.Q6J("svgIcon","heroicons_outline:printer"),e.xp6(9),e.Q6J("matDatepicker",n)("max",t.maxDate),e.xp6(1),e.Q6J("for",n),e.xp6(8),e.Q6J("ngClass",e.VKq(30,_,1==t.selectRemetente)),e.xp6(2),e.Q6J("ngClass",e.VKq(32,_,2==t.selectRemetente)),e.xp6(2),e.Q6J("ngClass",e.VKq(34,_,3==t.selectRemetente)),e.xp6(9),e.Q6J("ngForOf",t.searchRemetentes),e.xp6(5),e.Q6J("ngClass",e.VKq(36,_,1==t.selectDestinatario)),e.xp6(2),e.Q6J("ngClass",e.VKq(38,_,2==t.selectDestinatario)),e.xp6(2),e.Q6J("ngClass",e.VKq(40,_,3==t.selectDestinatario)),e.xp6(3),e.Q6J("ngIf",!((null==t.registoDetail?null:t.registoDetail.id)>0))("ngIfThen",a)("ngIfElse",l),e.xp6(6),e.Q6J("ngIf","ENTRADA"!=t.registoTipo),e.xp6(1),e.Q6J("ngClass",e.VKq(42,Ge,"ENTRADA"!=t.registoTipo)),e.xp6(3),e.Q6J("ngIf",t.showStributosDinamicos),e.xp6(2),e.Q6J("color","primary")("disabled",!t.entradaForm.valid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:pencil-alt")}},dependencies:[d.mk,d.sg,d.O5,d.RF,d.n9,U.ey,E.lW,G.d,h.KE,h.hX,h.R9,y.Hw,J.Nt,N.VK,N.OP,N.p6,O.gD,B.v6,Z.nu,Z.C0,$.Rr,p.Mq,p.hl,p.nW,T.pp,T.ib,T.yz,T.yK,c._Y,c.Fj,c.JJ,c.JL,c.Q7,c.nD,c.sg,c.u,ee.A9,ee.Yi,Ie.H],styles:[".ml-170{margin-left:170px}.mat-mdc-form-field-required-marker{color:rgb(220 38 38/var(--tw-text-opacity));margin-left:2px}.mat-mdc-tab-body-content{padding-top:0!important;padding-bottom:0!important}.dest-first{border-radius:5px 0 0 5px!important;padding-left:4px}.dest-last{border-radius:0 5px 5px 0!important;padding-right:4px}.file-size,#ngx-mat-fileinput-0,#ngx-mat-fileinput-1,#ngx-mat-fileinput-2{width:100%!important}\n"],encapsulation:2,changeDetection:0});class I{constructor(o,t,i,n,a,l,u){this._changeDetectorRef=o,this.dialogRef=t,this.fb=i,this._formBuilder=n,this._documentoService=a,this._entradaService=l,this.data=u,this.showAlert=!1,this.alert={type:"success",message:""}}ngOnInit(){this.getTypeDocumentos(),this.getEstados(),this._documentoService.getAllParticipantes().subscribe(o=>{this.participantes=o.data,this.searchParticipantes=o.data}),this.formPesquisa=this.fb.group({numeroDocumento:new c.NI(""),tipoId:new c.NI(""),assunto:new c.NI(""),remetenteId:new c.NI(""),destinatarioId:new c.NI(""),participanteId:new c.NI(""),estadoId:new c.NI(""),dtInitial:new c.NI(""),dtEnd:new c.NI(""),dtRegistoInitial:new c.NI(""),dtRegistoFinal:new c.NI("")})}onNoClick(){this.dialogRef.close()}getTypeDocumentos(){this._documentoService.getAllTypeDocumentos().subscribe(o=>{this.tipoDocumentos=o.data,this.searchTipoDocumentos=o.data})}getEstados(){this._documentoService.getAllEstados().subscribe(o=>{this.estados=o.data,this.searchEstados=o.data})}showAlertEvent(o){}filterEstados(o){this.searchEstados=this.estados.filter(t=>t.nome.toLowerCase().includes(o.target.value.toLowerCase()))}filterTypeDocumentos(o){this.searchTipoDocumentos=this.tipoDocumentos.filter(t=>t.nome.toLowerCase().includes(o.target.value.toLowerCase()))}filterParticipantes(o){this.searchParticipantes=this.participantes.filter(t=>t.name.toLowerCase().includes(o.target.value.toLowerCase()))}saveEntrada(o,t){let i=o.getRawValue();console.log("createEntrada"),this.createEntrada(i)}createEntrada(o){(null!=o.dynamicData||null!=o.dynamicData)&&(o.dynamicData=o?.dynamicData?.getRawValue()),o.confidencial=o.confidencial?1:0;const t={next:i=>{this.registo=i,this.dialogRef.close(this.registo)},error:i=>{this.alert={type:"error",message:`${i}`}}};this._entradaService.createEntrada(o).subscribe(t)}}I.\u0275fac=function(o){return new(o||I)(e.Y36(e.sBO),e.Y36(D.so),e.Y36(c.qu),e.Y36(c.QS),e.Y36(_e.c),e.Y36(xe._),e.Y36(D.WI))},I.\u0275cmp=e.Xpm({type:I,selectors:[["app-form-pesquisa"]],decls:5,vars:1,consts:[[1,"relative","overflow-auto"],[1,"relative","flex","flex-col"],[1,"border-t"],[1,"px-4","pt-4","bg-card","shadow","rounded","overflow-hidden"],[3,"anexosInputScanner","alertMessage","formulario"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"div",3)(4,"entrada-registo-form",4),e.NdJ("alertMessage",function(n){return t.showAlertEvent(n)})("formulario",function(n){return t.saveEntrada(n,null)}),e.qZA()()()()),2&o&&(e.xp6(4),e.Q6J("anexosInputScanner",t.data))},dependencies:[C]});var Q=r(5439),Ve=r(9957),m=r(2340),P=r(1135),Y=r(8505);class g{constructor(o){this._httpClient=o,this._pagination=new P.X(null),this._documento=new P.X(null),this._documentos=new P.X(null)}get pagination$(){return this._pagination.asObservable()}get documento$(){return this._documento.asObservable()}get documentos$(){return this._documentos.asObservable()}set documento$(o){o.subscribe(t=>{this._documento.next(t)})}getDocumentos(o){return this._httpClient.get(m.N.URL_ROOT_API+"/anexos/pendentes",{params:o}).pipe((0,Y.b)(t=>{this._pagination.next(t.pagination),this._documentos.next(t.data)}))}getDocumento(o){return this._httpClient.get(m.N.URL_ROOT_API+"/entradas/"+o).pipe((0,Y.b)(t=>{this._documento.next(t.data)}))}seachAdvancedDocument(o){return this._httpClient.get(m.N.URL_ROOT_API+"/pesquisa-documento",{params:o}).pipe((0,Y.b)(t=>{this._pagination.next(t.pagination),this._documentos.next(t.data)}))}get getDocumentosDefaultParams(){let o=new f.LE;return o=o.append("sort","id"),o=o.append("order","desc"),o=o.append("page",0),o=o.append("size",10),o}getAllTypeDocumentos(){return this._httpClient.get(m.N.URL_ROOT_API+"/tipos")}getAllEstados(){return this._httpClient.get(m.N.URL_ROOT_API+"/estados")}getAllParticipantes(){return this._httpClient.get(m.N.URL_ROOT_API+"/registo/participantes")}getAllRegistoPermissoes(o){return this._httpClient.get(m.N.URL_ROOT_API+"/registo-permissoes?registoId="+o)}auditSawEvent(o){return this._httpClient.post(m.N.URL_ROOT_API+"/entradas/audit",o)}updateEstado(o){return this._httpClient.put(m.N.URL_ROOT_API+"/registo/update-estado",o)}savePermissoes(o){return this._httpClient.post(m.N.URL_ROOT_API+"/registo-permissoes",o)}deleteUtilizadorPermissoes(o){return this._httpClient.delete(m.N.URL_ROOT_API+"/registo-permissoes/"+o)}}g.\u0275fac=function(o){return new(o||g)(e.LFG(f.eN))},g.\u0275prov=e.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"});var Be=r(4880),je=r(2534),$e=r(6757),Ke=r(8214);const He=["matDrawer"];function We(s,o){if(1&s&&e._UZ(0,"app-preview-detail",39),2&s){const t=e.oxw();e.Q6J("registo",t.selectedDocumento)}}function Xe(s,o){1&s&&(e.TgZ(0,"div",40),e._UZ(1,"mat-progress-bar",41),e.qZA()),2&s&&(e.xp6(1),e.Q6J("mode","indeterminate"))}function et(s,o){1&s&&(e.TgZ(0,"div",42)(1,"h2",43),e._uU(2," Documentos n\xe3o Classificados "),e.qZA()())}function tt(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"button",46),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.viewRegisto())}),e.TgZ(3,"b"),e._uU(4,"Clique aqui para Visualizar"),e.qZA(),e._uU(5,"."),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.alert.message," ")}}function ot(s,o){if(1&s&&(e.TgZ(0,"fuse-alert",44),e.YNc(1,tt,6,1,"div",45),e.qZA()),2&s){const t=e.oxw();e.Q6J("appearance","soft")("dismissible",!0)("dismissed",!0)("name","alertBoxDocumentos")("type",t.alert.type)("@shake","error"===t.alert.type),e.xp6(1),e.Q6J("ngIf","success"===t.alert.type)}}function it(s,o){if(1&s&&(e.TgZ(0,"mat-option",54),e._uU(1),e.qZA()),2&s){const t=o.$implicit;e.s9C("value",t.id),e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nome," ")}}function nt(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"mat-form-field",24)(1,"mat-select",47,48)(3,"mat-option")(4,"ngx-mat-select-search",49),e.NdJ("input",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.filterTypeDocumentos(n))}),e._UZ(5,"mat-icon",50),e.TgZ(6,"span",51),e._uU(7,"Origem/Scanner"),e.qZA()()(),e.TgZ(8,"mat-option",52),e._uU(9," Origem/Scanner "),e.qZA(),e.YNc(10,it,2,3,"mat-option",53),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(10),e.Q6J("ngForOf",t.searchLocalizacaoScanners)}}const st=function(s){return{"font-semibold text-primary":s}};function at(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"tr",68)(1,"td",69)(2,"input",70),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,u=e.oxw(2);return e.KtG(u.documentosSelecionados[l].selecionado=n)})("change",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.checkboxChange())}),e.qZA()(),e.TgZ(3,"td",71),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"label",72),e._uU(9),e.qZA()(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"uppercase"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.ALo(19,"date"),e.qZA(),e.TgZ(20,"td")(21,"button",73),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.anexoFullPage(a))}),e._UZ(22,"mat-icon",74),e.qZA(),e.TgZ(23,"a",75),e._UZ(24,"mat-icon",74),e.qZA()()()}if(2&s){const t=o.$implicit,i=o.index,n=e.oxw(2);e.Q6J("ngClass",e.VKq(18,st,t.id==(null==n.selectedDocumento?null:n.selectedDocumento.id))),e.xp6(2),e.Q6J("ngModel",n.documentosSelecionados[i].selecionado),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.nome),e.xp6(2),e.Q6J("ngClass",n.getCustomBadgeClass(null==t||null==t.origem?null:t.origem.nome)),e.xp6(1),e.Oqu(null==t||null==t.origem?null:t.origem.nome),e.xp6(2),e.Oqu(n.bytesToString(t.tamanho)),e.xp6(2),e.Oqu(e.lcZ(14,13,t.extensao)),e.xp6(3),e.Oqu(t.utilizador.name),e.xp6(2),e.Oqu(e.xi3(19,15,t.created_at,"dd/MM/yyyy hh:mm:ss")),e.xp6(4),e.Q6J("svgIcon","heroicons_outline:eye"),e.xp6(1),e.Q6J("href",n.anexoDownload(null==t?null:t.id),e.LSH),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:download")}}const rt=function(s){return{"pointer-events-none":s}},ct=function(){return[10,25,100,500]};function lt(s,o){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"table",55)(2,"tr",56)(3,"td",57)(4,"input",58),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.selecionarTodos=n)})("change",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.selectAll())}),e.qZA()(),e.TgZ(5,"td",59),e._uU(6,"Nr. Ord"),e.qZA(),e.TgZ(7,"td",60),e._uU(8,"Nome"),e.qZA(),e.TgZ(9,"td",61),e._uU(10,"Origem/Scanner"),e.qZA(),e.TgZ(11,"td",62),e._uU(12,"Tamanho"),e.qZA(),e.TgZ(13,"td",63),e._uU(14,"Extens\xe3o"),e.qZA(),e.TgZ(15,"td",64),e._uU(16,"Utilizador"),e.qZA(),e.TgZ(17,"td",65),e._uU(18,"Data"),e.qZA(),e.TgZ(19,"td"),e._uU(20,"Ac\xe7\xe3o"),e.qZA()(),e.YNc(21,at,25,20,"tr",66),e.qZA(),e._UZ(22,"mat-paginator",67),e.BQk()}if(2&s){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.selecionarTodos),e.xp6(17),e.Q6J("ngForOf",t.documentos),e.xp6(1),e.Q6J("ngClass",e.VKq(8,rt,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(10,ct))("showFirstLastButtons",!0)}}function mt(s,o){1&s&&(e.TgZ(0,"div",76),e._UZ(1,"mat-icon",77),e.TgZ(2,"div",78),e._uU(3," N\xe3o h\xe1 Documentos cadastrados! "),e.qZA()()),2&s&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:clipboard-list"))}class b{constructor(o,t,i,n,a,l,u,A,R,M,gt,ht){this._activatedRoute=o,this._changeDetectorRef=t,this._router=i,this._documentoService=n,this._fuseMediaWatcherService=a,this._drawerService=l,this.dialog=u,this._fuseAlertService=A,this._usersService=R,this.fb=M,this._anexosService=gt,this._anexosPendentes=ht,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new c.p4,this._unsubscribeAll=new pe.x,this.showAlert=!1,this.alert={type:"success",message:""},this.documentosSelecionados=[],this.opcoesDisabled=!0,this.classificarDisabled=!0,this.anexoDownloadDisabled=!0,this.units=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],this.resetForm(),this.maxDate=new Date}ngOnInit(){this._fuseMediaWatcherService.onMediaQueryChange$("(min-width: 1440px)").pipe((0,q.R)(this._unsubscribeAll)).subscribe(o=>{this.drawerMode=o.matches?"side":"over",this._changeDetectorRef.markForCheck()}),this._documentoService.pagination$.pipe((0,q.R)(this._unsubscribeAll)).subscribe(o=>{this.pagination=o,this._changeDetectorRef.markForCheck()}),this._documentoService.documentos$.subscribe(o=>{this.documentos=o}),this._usersService.groups$.subscribe(o=>{this.groupsList=o}),this._anexosPendentes.getLocalizacaoScanners().subscribe(o=>{this.localizacaoScanners=o,this.searchLocalizacaoScanners=o}),this._documentoService.getAllParticipantes().subscribe(o=>{this.participantes=o.data,this.searchParticipantes=o.data}),this.resetDocumentosSelecionados()}ngAfterViewInit(){this._drawerService.setDrawer(this.matDrawer),this._sort&&this._paginator&&(this._sort.sort({id:"id",start:"asc",disableClear:!0}),this._sort.sortChange.pipe((0,q.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0,this._changeDetectorRef.markForCheck()}),(0,ge.T)(this._sort.sortChange,this._paginator.page).pipe((0,he.w)(()=>{let o=new f.LE;return o=o.append("page",this._paginator.pageIndex),o=o.append("size",this._paginator.pageSize),o=o.append("sort",this._sort.active),o=o.append("order",this._sort.direction),this._documentoService.getDocumentos(o)})).subscribe(),this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}resetForm(){this.formPesquisa=this.fb.group({pesquisaPor:new c.NI(""),localizacaoScannerId:new c.NI(""),periodoInicio:new c.NI,periodoFim:new c.NI})}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}trackByFn(o,t){return t.id||o}showAlertEvent(o){this.alert=o,this.showAlert=!0,setTimeout(()=>{this._fuseAlertService.dismiss("alertBoxDocumentos"),this._changeDetectorRef.markForCheck()},15e3)}applyFilter(o){const t=o;if(null===t||null==t)this._documentoService.getDocumentos(this._documentoService.getDocumentosDefaultParams).subscribe();else{let i=new f.LE;i=i.append("criadoPor",t),this._documentoService.getDocumentos(i).subscribe(),this.searchInputControl.reset()}}updateDocumento(o){this.matDrawer.opened||this.matDrawer.open(),this.selectedDocumento=o,this._documentoService.auditSawEvent({id:this.selectedDocumento.id}).subscribe()}openDialog(o){this.dialog.open(I,{data:o.filter(i=>1==i.selecionado)}).updateSize("840px","680px").afterClosed().subscribe(i=>{null!=i&&(this.showAlert=!0,this.alert={type:"success",message:"Documentos classificados com sucesso. Registo N\xba: "+i.referencia},this._fuseAlertService.show("alertBoxDocumentos"),this.registoId=i.id,setTimeout(()=>{this._fuseAlertService.dismiss("alertBoxDocumentos"),this._changeDetectorRef.markForCheck(),this.showAlert=!1},15e3),this.searchDocumentos())})}viewRegisto(){this._router.navigate(["registo/entradas",this.registoId])}showRemententeGroupName(o){return this.groupsList.filter(t=>t.id==o).map(t=>t.name).toString()}showDestinatariosString(o){var t=o.filter(i=>i.tipo==L.H.ENTIDADE).map(i=>i.entidade.nome).toString();return t+=o.filter(i=>i.tipo==L.H.UTILIZADOR).map(i=>(""!=t?", ":"")+i.utilizador.name).toString(),t+=o.filter(i=>i.tipo==L.H.GRUPO).map(i=>(""!=t?", ":"")+this.showRemententeGroupName(i.grupoId)).toString()}getCustomBadgeClass(o){var t="text-blue-800 bg-blue-100";return"NOVO"==o?t="text-green-800 bg-green-100":"EM ELABORA\xc7\xc3O"==o?t="text-blue-800 bg-blue-100":"ARQUIVADO"==o?t="text-yellow-800 bg-yellow-100":"CONCLU\xcdDO"==o&&(t="text-gray-800 bg-gray-100"),t}searchDocumentos(){const o=this.formPesquisa.controls.periodoInicio.value,t=this.formPesquisa.controls.periodoFim.value,i=this.formPesquisa.controls.pesquisaPor.value,n=this.formPesquisa.controls.localizacaoScannerId.value;let a=new f.LE;""!=o&&null!=o&&(a=a.append("periodoInicio",Q(o).format("YYYY-MM-DD"))),""!=t&&null!=t&&(a=a.append("periodoFim",Q(t).format("YYYY-MM-DD"))),""!=i&&(a=a.append("pesquisaPor",i)),""!=n&&(a=a.append("localizacaoScannerId",n)),a=a.append("page",0).append("size",8).append("sort",this._sort?.active).append("order",this._sort?.direction),this._documentoService.getDocumentos(a).subscribe(l=>{this.documentos=l.data,console.log(l),this.resetDocumentosSelecionados()})}getFormParams(o,t){let i=new f.LE;i=i.append("pendentes",!0);for(const n of Object.keys(o))o[n]&&(i=t.includes(n)?i.append(n.toString(),Q(o[n]).format("YYYY-MM-DD")):i.append(n.toString(),o[n]));return i}refresh(){this.resetForm(),this._documentoService.getDocumentos(this._documentoService.getDocumentosDefaultParams).subscribe(),this._documentoService.documentos$.subscribe(o=>{this.documentos=o})}filterTypeDocumentos(o){this.searchLocalizacaoScanners=this.localizacaoScanners.filter(t=>t.nome.toLowerCase().includes(o.target.value.toLowerCase()))}filterParticipantes(o){this.searchParticipantes=this.participantes.filter(t=>t.name.toLowerCase().includes(o.target.value.toLowerCase()))}resetDocumentosSelecionados(){this.documentosSelecionados=[],this.documentos.forEach(o=>{this.documentosSelecionados.push({id:o.id.toString(),nome:o.nome,selecionado:!1})}),this._changeDetectorRef.markForCheck()}checkboxChange(){let o=this.documentosSelecionados.filter(t=>1==t.selecionado).length;this.opcoesDisabled=1!=o,o>0?(this.anexoDownloadDisabled=!1,this.classificarDisabled=!1):(this.anexoDownloadDisabled=!0,this.classificarDisabled=!0)}selectAll(){this.documentosSelecionados.forEach(o=>{o.id=o.id,o.selecionado=this.selecionarTodos}),this.checkboxChange()}bytesToString(o){let t=0,i=parseInt(o,10)||0;for(;i>=1024&&++t;)i/=1024;return i.toFixed(i<10&&t>0?1:0)+" "+this.units[t]}anexoFullPage(o){this.dialog.open(Ve.O,{data:{anexo:{id:o.id,tipo:"D",extensao:o.extensao}}}).updateSize("1000px","700px")}anexoDownload(o){return m.N.URL_ROOT_API+"/anexos/pendentes/view/"+o}}b.\u0275fac=function(o){return new(o||b)(e.Y36(w.gz),e.Y36(e.sBO),e.Y36(w.F0),e.Y36(g),e.Y36(Be.T),e.Y36(W.z),e.Y36(D.uw),e.Y36(j.jm),e.Y36(X.f),e.Y36(c.qu),e.Y36(je.d),e.Y36($e.c))},b.\u0275cmp=e.Xpm({type:b,selectors:[["app-list"]],viewQuery:function(o,t){if(1&o&&(e.Gf(He,5),e.Gf(k.NW,5),e.Gf(F.YE,5)),2&o){let i;e.iGM(i=e.CRH())&&(t.matDrawer=i.first),e.iGM(i=e.CRH())&&(t._paginator=i.first),e.iGM(i=e.CRH())&&(t._sort=i.first)}},decls:48,vars:25,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden","h-full"],[1,"h-full",3,"backdropClick"],[1,"w-full","dark:bg-gray-900",2,"width","680px!important",3,"mode","opened","position","disableClose"],["matDrawer",""],[3,"registo",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-4","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-secondary"],["class","mt-2",4,"ngIf"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4",2,"background-color","white","border-radius","5px"],[1,"flex","items-center","px-4",3,"click"],[1,"scale-[.75]",3,"svgIcon"],[1,"flex","items-center"],[3,"svgIcon"],[3,"appearance","dismissible","dismissed","name","type",4,"ngIf"],[1,"relative","flex-auto","h-full","bg-card","dark:bg-transparent"],[1,"flex","w-full","px-4",3,"formGroup"],[1,"flex-auto","fuse-mat-dense","fuse-mat-rounded","mt-5","mr-4"],["maxlength","100","formControlName","pesquisaPor","matInput","",3,"placeholder"],[3,"formGroup","rangePicker"],["matStartDate","","placeholder","Data inicio","formControlName","periodoInicio"],["matEndDate","","placeholder","Data fim","formControlName","periodoFim",3,"maxlength"],["matSuffix","",3,"for"],["campaignOnePicker",""],["class","flex-auto fuse-mat-dense fuse-mat-rounded mt-5 mr-4",4,"ngIf"],["mat-flat-button","",1,"ml-4","mt-5",3,"color","click"],["mat-flat-button","",1,"ml-4","mt-5",3,"color","disabled","click"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],[4,"ngIf","ngIfElse"],["noDocumentos",""],[3,"registo"],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[1,"mt-2"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[3,"appearance","dismissible","dismissed","name","type"],[4,"ngIf"],[3,"click"],["formControlName","localizacaoScannerId"],["singleSelect",""],["placeholderLabel","Pesquisar o tipo de documento..",3,"input"],["svgIcon","heroicons_outline:x"],["ngxMatSelectNoEntriesFound",""],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matSort","",1,""],[1,"sticky","top-0","h-10","shadow","text-sm","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"pl-5","pr-4"],["type","checkbox",3,"ngModel","ngModelChange","change"],["mat-sort-header","id",1,""],["mat-sort-header","nome"],["mat-sort-header","localizacaoScannerId"],["mat-sort-header","tamanho"],["mat-sort-header","extensao"],["mat-sort-header","utilizadorId"],["mat-sort-header","created_at"],["class","h-9 border-b cursor-p text-sm mat-row",3,"ngClass",4,"ngFor","ngForOf"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"h-9","border-b","cursor-p","text-sm","mat-row",3,"ngClass"],[1,"pl-5","pr-4","cursor-p"],["type","checkbox",2,"padding","40px","cursor","pointer",3,"ngModel","ngModelChange","change"],[1,"cursor-p"],[1,"py-0.5","px-2","rounded-full","text-center","font-medium","font-size-08",3,"ngClass"],[1,"mt-2",3,"click"],[1,"scale-[.75]","rounded","pt-1",3,"svgIcon"],[1,"mt-2",3,"href"],[1,"flex","flex-auto","flex-col","items-center","mt-30"],[1,"icon-size-24",3,"svgIcon"],[1,"text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(o,t){if(1&o&&(e.TgZ(0,"div",0)(1,"mat-drawer-container",1),e.NdJ("backdropClick",function(){return t.onBackdropClicked()}),e.TgZ(2,"mat-drawer",2,3),e.YNc(4,We,1,1,"app-preview-detail",4),e.qZA(),e.TgZ(5,"mat-drawer-content",5)(6,"div",6)(7,"div",7),e.YNc(8,Xe,2,1,"div",8),e.TgZ(9,"div",9)(10,"div",10)(11,"div")(12,"a",11),e._uU(13,"Pesquisa"),e.qZA()(),e.TgZ(14,"div",12),e._UZ(15,"mat-icon",13),e.TgZ(16,"span",14),e._uU(17,"Pendentes"),e.qZA()()(),e.YNc(18,et,3,0,"div",15),e.qZA(),e.TgZ(19,"div",16)(20,"button",17),e.NdJ("click",function(){return t.refresh()}),e._UZ(21,"mat-icon",18),e.qZA(),e.TgZ(22,"button",19),e._UZ(23,"mat-icon",20),e.qZA()()(),e.YNc(24,ot,2,7,"fuse-alert",21),e.TgZ(25,"div",22)(26,"form",23)(27,"mat-form-field",24),e._UZ(28,"input",25),e.qZA(),e.TgZ(29,"mat-form-field",24)(30,"mat-date-range-input",26),e._UZ(31,"input",27)(32,"input",28),e.qZA(),e._UZ(33,"mat-datepicker-toggle",29)(34,"mat-date-range-picker",null,30),e.qZA(),e.YNc(36,nt,11,1,"mat-form-field",31),e.TgZ(37,"button",32),e.NdJ("click",function(){return t.searchDocumentos()}),e._UZ(38,"mat-icon",20),e.qZA(),e.TgZ(39,"button",33),e.NdJ("click",function(){return t.openDialog(t.documentosSelecionados)}),e._UZ(40,"mat-icon",20),e.TgZ(41,"span",34),e._uU(42,"Classificar"),e.qZA()()(),e.TgZ(43,"div",35)(44,"div",36),e.YNc(45,lt,23,11,"ng-container",37),e.YNc(46,mt,4,1,"ng-template",null,38,e.W1O),e.qZA()()()()()()()),2&o){const i=e.MAs(3),n=e.MAs(35),a=e.MAs(47);e.xp6(2),e.Q6J("mode",t.drawerMode)("opened",!1)("position","end")("disableClose",!0),e.xp6(2),e.Q6J("ngIf",null!=t.selectedDocumento),e.xp6(4),e.Q6J("ngIf",t.isLoading),e.xp6(7),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(3),e.Q6J("ngIf",!i.opened),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:refresh"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:dots-vertical"),e.xp6(1),e.Q6J("ngIf",t.showAlert),e.xp6(2),e.Q6J("formGroup",t.formPesquisa),e.xp6(2),e.Q6J("placeholder","Pesquisar por"),e.xp6(2),e.Q6J("formGroup",t.formPesquisa)("rangePicker",n),e.xp6(2),e.Q6J("maxlength",t.maxDate),e.xp6(1),e.Q6J("for",n),e.xp6(3),e.Q6J("ngIf",!i.opened),e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:search"),e.xp6(1),e.Q6J("color","primary")("disabled",t.classificarDisabled),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:pencil-alt"),e.xp6(5),e.Q6J("ngIf",t.documentos.length>0)("ngIfElse",a)}},dependencies:[U.ey,E.lW,p.nW,p.wx,p.zY,p.By,p._g,h.KE,h.R9,y.Hw,J.Nt,V.pW,O.gD,S.jA,S.kh,S.LW,k.NW,F.YE,F.nU,d.mk,d.sg,d.O5,c._Y,c.Fj,c.Wl,c.JJ,c.JL,c.nD,c.On,c.sg,c.u,Z.nu,Z.C0,Ke.W,d.gd,d.uU],styles:[".cursor-p:hover{cursor:pointer!important;color:#4f46e5}.padding-l-40{padding-left:40px!important}.mat-row:nth-child(even){background-color:#fff}.mat-row:nth-child(odd){background-color:rgb(248 250 252/var(--tw-bg-opacity))}.font-size-08{font-size:.8em}input[type=checkbox]{transform:scale(1.3);padding:5px}.checkboxtext{font-size:90%;display:inline}\n"],encapsulation:2,data:{animation:fe.L},changeDetection:0});class x{constructor(o){this._documentoService=o}resolve(o,t){return this._documentoService.getDocumentos(this._documentoService.getDocumentosDefaultParams)}}x.\u0275fac=function(o){return new(o||x)(e.LFG(g))},x.\u0275prov=e.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"});var dt=r(1087),ut=r(516);const pt=[{path:"",component:b,resolve:{documentos:x,grupos:K.zH,documentosTipos:dt.G,entidades:ut.S,users:K.oD}}];class v{}v.\u0275fac=function(o){return new(o||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({imports:[w.Bz.forChild(pt),te._t,oe.Bb,E.ot,ie.p9,p.FA,G.t,h.lN,y.Ps,J.c,ne.En,N.Tx,V.Cv,se.Fk,U.si,O.LD,S.SJ,ae.AV,k.TU,F.JX,re.V,B.S1,ce.m,Z.Co,D.Is,T.To,j.fC,le.Nh,$.rP,me.y,de.k,ue.AuditoriaModule]})}}]);